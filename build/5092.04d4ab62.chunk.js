"use strict";(self.webpackChunkstrapi_cloudinary=self.webpackChunkstrapi_cloudinary||[]).push([[5092],{15092:(b,T,s)=>{s.r(T),s.d(T,{ProfilePage:()=>rs});var e=s(74081),_=s(27279),y=s(51926),C=s(73354),p=s(27875),Q=s(74758),k=s(48102),O=s(93415),D=s(10701),x=s(32370),R=s(23298),E=s(74577),$=s(12881),q=s(28040),L=s(63738),d=s(15530),ss=s(59082),S=s(98264),w=s(92191),es=s(71563),as=s(51943),V=s(364),U=s(61020),Z=s(40464),Y=s(19003),N=s(47853),u=s(24468),G=s(66947),ts=s(44506),vs=s(15816),As=s(97442),Is=s(13576),Ts=s(87830),Cs=s(47184),xs=s(59461),Rs=s(49204),Us=s(74919),Bs=s(29206),js=s(98934),Ws=s(43433),Ks=s(75719),ys=s(8175),Ss=s(6078),ws=s(55783),Zs=s(92249),Ns=s(41942),Hs=s(22919),Fs=s(53915),zs=s(75041),Qs=s(30200),$s=s(91379),Vs=s(33299),Ys=s(33409),Gs=s(63645),Js=s(7988),Xs=s(7055),bs=s(26757),ks=s(58311),qs=s(29510),se=s(16946),ee=s(10124),ae=s(69530),te=s(86961),ne=s(51527),re=s(19764),oe=s(42982),de=s(26126),ie=s(64797),le=s(85811);const ns=N.Ry().shape({...ts.C,currentPassword:N.Z_().when(["password","confirmPassword"],(t,i,r)=>t||i?r.required(d.I0.required):r),preferedLanguage:N.Z_().nullable()}),rs=()=>{const t=(0,u.f)(n=>n.admin_app.language.localeNames),{setUserDisplayName:i}=(0,d.L7)(),{formatMessage:r}=(0,U.Z)(),{trackUsage:a}=(0,d.rS)(),m=(0,d.lm)(),{lockApp:o,unlockApp:M}=(0,d.o1)(),{notifyStatus:F}=(0,y.G)(),v=(0,u.f)(n=>n.admin_app.theme.currentTheme),B=(0,u.l)(),{get:c,put:g}=(0,d.kY)();(0,d.go)();const{isLoading:ls,data:A,refetch:_s}=(0,Z.useQuery)("user",async()=>{const{data:n}=await c("/admin/users/me");return n.data},{onSuccess(){F(r({id:"Settings.profile.form.notify.data.loaded",defaultMessage:"Your profile data has been loaded"}))},onError(){m({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),{isLoading:ms,data:Es}=(0,Z.useQuery)(["providers","isSSOLocked"],async()=>{const{data:{data:n}}=await c("/admin/providers/isSSOLocked");return n},{enabled:window.strapi.isEE&&window.strapi.features.isEnabled("sso"),onError(){m({type:"warning",message:{id:"Settings.permissions.users.sso.provider.error"}})}}),cs=ls||ms,X=(0,Z.useMutation)(async n=>{const{confirmPassword:h,currentTheme:P,...f}=n;let l=f;if((W=>"password"in W)(l)&&l.password===""){const{password:W,currentPassword:K,...z}=l;l=z}const{data:I}=await g("/admin/users/me",l);return{...I.data,currentTheme:P}},{async onSuccess(n){await _s();const{email:h,firstname:P,lastname:f,username:l,preferedLanguage:j}=n;d.I8.setUserInfo({email:h,firstname:P,lastname:f,username:l,preferedLanguage:j});const I=n.username||(0,G.g)(n.firstname??"",n.lastname);i(I),n.preferedLanguage&&B((0,u.s)(n.preferedLanguage)),B((0,u.m)(n.currentTheme)),a("didChangeMode",{newMode:n.currentTheme}),m({type:"success",message:{id:"notification.success.saved",defaultMessage:"Saved"}})},async onSettled(){M()}}),{isLoading:Ms}=X,gs=async(n,{setErrors:h})=>{o();const P=n.username;X.mutate({...n,username:P},{onError(f){const l=f?.response?.data;return l?.data?h(l.data):m({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}})};if(cs||!A)return(0,e.jsxs)(C.o,{"aria-busy":"true",children:[(0,e.jsx)(V.q,{title:r({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),(0,e.jsx)(p.T,{title:r({id:"Settings.profile.form.section.profile.page.title",defaultMessage:"Profile page"})}),(0,e.jsx)(Q.D,{children:(0,e.jsx)(d.dO,{})})]});const Ps=Es?.isSSOLocked??!1,{email:fs,firstname:us,lastname:hs,username:ps,preferedLanguage:Os}=A,Ds={email:fs,firstname:us,lastname:hs,username:ps,preferedLanguage:Os,currentTheme:v,confirmPassword:"",password:""};return(0,e.jsxs)(C.o,{"aria-busy":Ms,children:[(0,e.jsx)(V.q,{title:r({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),(0,e.jsx)(es.J9,{onSubmit:gs,initialValues:Ds,validateOnChange:!1,validationSchema:ns,enableReinitialize:!0,children:({errors:n,values:{email:h,firstname:P,lastname:f,username:l,preferedLanguage:j,currentTheme:I,...W},handleChange:K,isSubmitting:z,dirty:Ls})=>(0,e.jsxs)(d.l0,{children:[(0,e.jsx)(p.T,{title:A.username||(0,G.g)(A.firstname??"",A.lastname),primaryAction:(0,e.jsx)(k.z,{startIcon:(0,e.jsx)(ss.Z,{}),loading:z,type:"submit",disabled:!Ls,children:r({id:"global.save",defaultMessage:"Save"})})}),(0,e.jsx)(O.x,{paddingBottom:10,children:(0,e.jsx)(Q.D,{children:(0,e.jsxs)(D.k,{direction:"column",alignItems:"stretch",gap:6,children:[(0,e.jsx)(is,{errors:n,onChange:K,values:{firstname:P,lastname:f,username:l,email:h}}),!Ps&&(0,e.jsx)(os,{errors:n,onChange:K,values:W}),(0,e.jsx)(ds,{onChange:K,values:{preferedLanguage:j,currentTheme:I},localeNames:t})]})})})]})})]})},os=({errors:t,onChange:i,values:r})=>{const{formatMessage:a}=(0,U.Z)(),[m,o]=_.useState(!1),[M,F]=_.useState(!1),[v,B]=_.useState(!1);return(0,e.jsx)(O.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,e.jsxs)(D.k,{direction:"column",alignItems:"stretch",gap:4,children:[(0,e.jsx)(x.Z,{variant:"delta",as:"h2",children:a({id:"global.change-password",defaultMessage:"Change password"})}),(0,e.jsx)(R.r,{gap:5,children:(0,e.jsx)(E.P,{s:12,col:6,children:(0,e.jsx)($.o,{error:t.currentPassword?a({id:t.currentPassword,defaultMessage:t.currentPassword}):"",onChange:i,value:r.currentPassword,label:a({id:"Auth.form.currentPassword.label",defaultMessage:"Current Password"}),name:"currentPassword",type:m?"text":"password",endAction:(0,e.jsx)(H,{onClick:c=>{c.stopPropagation(),o(g=>!g)},label:a(m?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"}),children:m?(0,e.jsx)(S.Z,{}):(0,e.jsx)(w.Z,{})})})})}),(0,e.jsxs)(R.r,{gap:5,children:[(0,e.jsx)(E.P,{s:12,col:6,children:(0,e.jsx)(J,{error:t.password?a({id:t.password,defaultMessage:t.password}):"",onChange:i,value:r.password,label:a({id:"global.password",defaultMessage:"Password"}),name:"password",type:M?"text":"password",autoComplete:"new-password",endAction:(0,e.jsx)(H,{onClick:c=>{c.stopPropagation(),F(g=>!g)},label:a(M?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"}),children:M?(0,e.jsx)(S.Z,{}):(0,e.jsx)(w.Z,{})})})}),(0,e.jsx)(E.P,{s:12,col:6,children:(0,e.jsx)(J,{error:t.confirmPassword?a({id:t.confirmPassword,defaultMessage:t.confirmPassword}):"",onChange:i,value:r.confirmPassword,label:a({id:"Auth.form.confirmPassword.label",defaultMessage:"Confirm Password"}),name:"confirmPassword",type:v?"text":"password",autoComplete:"new-password",endAction:(0,e.jsx)(H,{onClick:c=>{c.stopPropagation(),B(g=>!g)},label:a(v?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"}),children:v?(0,e.jsx)(S.Z,{}):(0,e.jsx)(w.Z,{})})})})]})]})})},J=(0,Y.default)($.o)`
  ::-ms-reveal {
    display: none;
  }
`,H=(0,Y.default)(q.E)`
  svg {
    height: ${(0,d.Q1)(16)};
    width: ${(0,d.Q1)(16)};
    path {
      fill: ${({theme:t})=>t.colors.neutral600};
    }
  }
`,ds=({onChange:t,values:i,localeNames:r})=>{const{formatMessage:a}=(0,U.Z)(),m=(0,u.f)(o=>o.admin_app.theme.availableThemes);return(0,e.jsx)(O.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,e.jsxs)(D.k,{direction:"column",alignItems:"stretch",gap:4,children:[(0,e.jsxs)(D.k,{direction:"column",alignItems:"stretch",gap:1,children:[(0,e.jsx)(x.Z,{variant:"delta",as:"h2",children:a({id:"Settings.profile.form.section.experience.title",defaultMessage:"Experience"})}),(0,e.jsx)(x.Z,{children:a({id:"Settings.profile.form.section.experience.interfaceLanguageHelp",defaultMessage:"Preference changes will apply only to you. More information is available {here}."},{here:(0,e.jsx)(O.x,{as:"a",color:"primary600",target:"_blank",rel:"noopener noreferrer",href:"https://docs.strapi.io/developer-docs/latest/development/admin-customization.html#locales",children:a({id:"Settings.profile.form.section.experience.here",defaultMessage:"here"})})})})]}),(0,e.jsxs)(R.r,{gap:5,children:[(0,e.jsx)(E.P,{s:12,col:6,children:(0,e.jsx)(L.q4,{label:a({id:"Settings.profile.form.section.experience.interfaceLanguage",defaultMessage:"Interface language"}),placeholder:a({id:"global.select",defaultMessage:"Select"}),hint:a({id:"Settings.profile.form.section.experience.interfaceLanguage.hint",defaultMessage:"This will only display your own interface in the chosen language."}),onClear:()=>{t({target:{name:"preferedLanguage",value:null}})},clearLabel:a({id:"Settings.profile.form.section.experience.clear.select",defaultMessage:"Clear the interface language selected"}),value:i.preferedLanguage,onChange:o=>{t({target:{name:"preferedLanguage",value:o}})},children:Object.entries(r).map(([o,M])=>(0,e.jsx)(L.ag,{value:o,children:M},o))})}),(0,e.jsx)(E.P,{s:12,col:6,children:(0,e.jsxs)(L.q4,{label:a({id:"Settings.profile.form.section.experience.mode.label",defaultMessage:"Interface mode"}),placeholder:a({id:"components.Select.placeholder",defaultMessage:"Select"}),hint:a({id:"Settings.profile.form.section.experience.mode.hint",defaultMessage:"Displays your interface in the chosen mode."}),value:i.currentTheme,onChange:o=>{t({target:{name:"currentTheme",value:o}})},children:[(0,e.jsx)(L.ag,{value:"system",children:a({id:"Settings.profile.form.section.experience.mode.option-system-label",defaultMessage:"Use system settings"})}),m.map(o=>(0,e.jsx)(L.ag,{value:o,children:a({id:"Settings.profile.form.section.experience.mode.option-label",defaultMessage:"{name} mode"},{name:a({id:o,defaultMessage:as(o)})})},o))]})})]})]})})},is=({errors:t,onChange:i,values:r})=>{const{formatMessage:a}=(0,U.Z)();return(0,e.jsx)(O.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,e.jsxs)(D.k,{direction:"column",alignItems:"stretch",gap:4,children:[(0,e.jsx)(x.Z,{variant:"delta",as:"h2",children:a({id:"global.profile",defaultMessage:"Profile"})}),(0,e.jsxs)(R.r,{gap:5,children:[(0,e.jsx)(E.P,{s:12,col:6,children:(0,e.jsx)(d.jm,{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},error:t.firstname,onChange:i,value:r.firstname,type:"text",name:"firstname",required:!0})}),(0,e.jsx)(E.P,{s:12,col:6,children:(0,e.jsx)(d.jm,{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},error:t.lastname,onChange:i,value:r.lastname,type:"text",name:"lastname"})}),(0,e.jsx)(E.P,{s:12,col:6,children:(0,e.jsx)(d.jm,{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},error:t.email,onChange:i,value:r.email,type:"email",name:"email",required:!0})}),(0,e.jsx)(E.P,{s:12,col:6,children:(0,e.jsx)(d.jm,{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},error:t.username,onChange:i,value:r.username,type:"text",name:"username"})})]})]})})}},44506:(b,T,s)=>{s.d(T,{C:()=>y});var e=s(15530),_=s(47853);const y={firstname:_.Z_().trim().required(e.I0.required),lastname:_.Z_(),email:_.Z_().email(e.I0.email).lowercase().required(e.I0.required),username:_.Z_().nullable(),password:_.Z_().min(8,e.I0.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:_.Z_().min(8,e.I0.minLength).oneOf([_.iH("password"),null],"components.Input.error.password.noMatch").when("password",(C,p)=>C?p.required(e.I0.required):p)}}}]);
